webpackJsonp([2],{0:function(module,exports,__webpack_require__){module.exports=__webpack_require__(96)},34:function(module,exports){},96:function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_jsx=function(){var REACT_ELEMENT_TYPE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function createRawReactElement(type,props,key,children){var defaultProps=type&&type.defaultProps,childrenLength=arguments.length-3;if(props||0===childrenLength||(props={}),props&&defaultProps)for(var propName in defaultProps)void 0===props[propName]&&(props[propName]=defaultProps[propName]);else props||(props=defaultProps||{});if(1===childrenLength)props.children=children;else if(childrenLength>1){for(var childArray=Array(childrenLength),i=0;i<childrenLength;i++)childArray[i]=arguments[i+3];props.children=childArray}return{$$typeof:REACT_ELEMENT_TYPE,type:type,key:void 0===key?null:""+key,ref:null,props:props,_owner:null}}}(),_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_react=__webpack_require__(21),_react2=_interopRequireDefault(_react),_reactDom=__webpack_require__(37),_reactDom2=_interopRequireDefault(_reactDom),_redux=__webpack_require__(33),Redux=_interopRequireWildcard(_redux),_reactRedux=__webpack_require__(53);__webpack_require__(34);var config={dataSrc:"data.json"},_ref=_jsx("div",{className:"flight-title"},void 0,"Выберите авиакомпанию:"),FlightAppCls=function(_React$Component){function FlightAppCls(){return _classCallCheck(this,FlightAppCls),_possibleConstructorReturn(this,(FlightAppCls.__proto__||Object.getPrototypeOf(FlightAppCls)).apply(this,arguments))}return _inherits(FlightAppCls,_React$Component),_createClass(FlightAppCls,[{key:"componentDidMount",value:function componentDidMount(){this.props.loadFlights(config.dataSrc)}},{key:"render",value:function render(){var _props=this.props,flights=_props.flights,carrier=_props.carrier,carriers=flights.length?flights.reduce(function(result,item){return result.indexOf(item.carrier)==-1&&result.push(item.carrier),result},[]):[];return carriers.sort(),_jsx(_reactRedux.Provider,{store:this.props.store},void 0,_jsx("div",{className:"flight-app"},void 0,_ref,_jsx(FlightSelector,{list:carriers,current:carrier,onChange:this.props.changeCarrier}),_jsx(FlightList,{flights:flights,carrier:carrier})))}}]),FlightAppCls}(_react2.default.Component),mapperStoreStateToProps=function mapperStoreStateToProps(store){return{flights:store.flightApp.flights,carrier:store.flightApp.carrier}},mapperDispatchToProps=function mapperDispatchToProps(dispatch,props){return{changeCarrier:function changeCarrier(evt){dispatch({type:"CHANGE_CARRIER",carrier:evt.target.value})},loadFlights:function loadFlights(url){dispatch({types:["FLIGHTS_REQUEST","FLIGHTS_SUCCESS","FLIGHTS_ERR"],promise:function promise(){return _loadFlights(url)}})}}},_loadFlights=function _loadFlights(url){return fetch(url,{}).then(function(response){if(response.ok)return response.json();throw"NetworkError: "+response.status+" "+response.statusText+" "+response.url}).then(function(data){if(data){if(Array.isArray(data.flights)){var flights=data.flights;return flights.sort(function(a,b){return a.arrival<b.arrival?-1:a.arrival==b.arrival?a.departure<b.departure?-1:a.departure==b.departure?0:1:1}),{flights:flights}}throw"ServerError: No valid data"}})},FlightApp=(0,_reactRedux.connect)(mapperStoreStateToProps,mapperDispatchToProps)(FlightAppCls),_ref2=_jsx("option",{value:""},void 0,"Все авиакомании"),FlightSelector=function FlightSelector(props){var list=props.list,current=props.current,onChange=props.onChange;return _jsx("select",{className:"flight-selector",value:current||"",onChange:onChange},void 0,_ref2,list.length?list.map(function(item){return _jsx("option",{value:item},void 0,item)}):null)},FlightList=function FlightList(props){var flights=props.flights,carrier=props.carrier,list=flights.length?carrier?flights.filter(function(item){return item.carrier==carrier}):flights:[];return _jsx("div",{className:"flight-list"+(list.length?"":" empty")},void 0,list.length?list.map(function(item){return _react2.default.createElement(FlightEntry,item)}):"Нет данных...")},FlightEntry=function FlightEntry(entry){var dt1=new Date(entry.arrival),dt2=new Date(entry.departure),f=function f(t){var h=t.getHours(),m=t.getMinutes();return(h<10?"0"+h:h)+":"+(m<10?"0"+m:m)};return _jsx("div",{className:"flight-entry"},void 0,_jsx("div",{className:"flight-entry-id"},void 0,"рейс № ",_jsx("span",{},void 0,entry.id)),_jsx("div",{className:"flight-entry-direction"},void 0,entry.direction.from," - ",entry.direction.to),_jsx("div",{className:"flight-entry-arrival"},void 0,"Вылет ",_jsx("span",{className:"date"},void 0,dt1.toLocaleDateString())," в ",_jsx("span",{className:"time"},void 0,f(dt1))),_jsx("div",{className:"flight-entry-departure"},void 0,"Прилёт ",_jsx("span",{className:"date"},void 0,dt2.toLocaleDateString())," в ",_jsx("span",{className:"time"},void 0,f(dt2))),_jsx("div",{className:"flight-entry-carrier"},void 0,"Авиакомпания ",_jsx("span",{},void 0,entry.carrier)))},createStore=function createStore(initData){var initStates={flightApp:{flights:[],carrier:null}},reducers={flightApp:function flightApp(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initStates.flightApp,action=arguments[1];switch(action.type){case"CHANGE_CARRIER":return _extends({},state,{carrier:action.carrier});case"FLIGHTS_REQUEST":return state;case"FLIGHTS_SUCCESS":return _extends({},state,{flights:action.flights});case"FLIGHTS_ERR":return console.log(action.error),state;default:return state}}},r=Redux.combineReducers(reducers);return Redux.applyMiddleware(middleware)(Redux.createStore)(r,initData)},middleware=function middleware(){return function(next){return function(action){var promise=action.promise,types=action.types,rest=_objectWithoutProperties(action,["promise","types"]);if(!promise)return next(action);var _types=_slicedToArray(types,3),REQUEST=_types[0],SUCCESS=_types[1],FAILURE=_types[2];return next(_extends({type:REQUEST},rest)),promise().then(function(result){next(_extends({type:SUCCESS},result,rest))},function(err){next(_extends({type:FAILURE,error:""+err},rest))})}}},store=createStore();_reactDom2.default.render(_jsx(FlightApp,{store:store}),document.getElementById("react-root"))}});
//# sourceMappingURL=main-2.js.map